# SQL Analysis of User Orders

This repository contains the SQL query and results for an exercise focused on analyzing user order data. The goal was to create a new table, `user_orders`, summarizing key information for users who have placed at least 5 orders.

## Project Description

The exercise involved working with three tables:

-   **Orders:** Details about each order placed.
-   **Users:** Information about the app users, including their signup date.
-   **Stores:** Information about the partner stores.

The SQL query constructs a new table, `user_orders`, with the following information for users with 5 or more orders:

-   **User ID:** The unique identifier of the user.
-   **Time (in days) since signup:** The duration in days between the user's signup date and the current date (as of the query execution).
-   **Total number of orders:** The total count of orders placed by the user.
-   **Average order value:** The average value of all orders placed by the user.
-   **Favourite store:** The name of the store where the user has placed the most orders. In case of a tie, the store with the most recent order is selected.
-   **% of delivered orders:** The percentage of the user's orders that have a 'delivered' status.
-   **Last order time:** The timestamp of the user's most recent order.
-   **Time (in days) between second last and last order:** The difference in days between the user's last and second-to-last order.

## Files in this Repository

-   `orders.sql`: Contains the `CREATE TABLE` and `INSERT INTO` statements for the `Orders` table.
-   `users.sql`: Contains the `CREATE TABLE` and `INSERT INTO` statements for the `Users` table.
-   `stores.sql`: Contains the `CREATE TABLE` and `INSERT INTO` statements for the `Stores` table.
-   `README.md`: This file, providing an overview of the project.
-   `final result.csv`: A CSV file containing the results of the `user_orders` table generated by the query.

## How to Run the Query

1.  Ensure you have a SQL database environment (e.g., PostgreSQL, MySQL, SQLite).
2.  Execute the `.sql` files in the following order to create and populate the tables:
    -   `users.sql`
    -   `stores.sql`
    -   `orders.sql`
3.  Run the `user_orders_query.sql` against your database. This will create the `user_orders` table.
4.  You can export the contents of the `user_orders` table to a CSV file for easier viewing.

## Key Learnings

This exercise demonstrates the ability to:

-   Perform complex SQL queries involving joins and aggregations.
-   Calculate time differences and percentages within SQL.
-   Identify trends and patterns in user order data.
-   Handle tie-breaking logic in SQL queries.
